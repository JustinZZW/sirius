package de.unijena.bioinf.ChemistryBase.fp;

/**
 * ECFP
 * Describes a substructure in a molecule via a hash value
 */
public final class ExtendedConnectivityProperty extends MolecularProperty {

    private final boolean isFunctional;
    private final byte diameter;
    private final int hash;

    public ExtendedConnectivityProperty(byte diameter, boolean isFunctional, int hash) {
        this.hash = hash;
        this.diameter = diameter;
        this.isFunctional = isFunctional;
    }
    public ExtendedConnectivityProperty(int hash) {
        this(DIAMETER, FUNCTIONAL, hash);
    }

    public boolean isFunctional() {
        return isFunctional;
    }

    public int getDiameter() {
        return diameter;
    }

    public int getHash() {
        return hash;
    }

    /**
     * Quick Workaround. Just put all these stuff into these class
     * Although it should be somewhere else...
     * TODO: better solution
     */

    public static int getHashValue(int index) {
        return HASHS[index];
    }

    public static int getFingerprintLength() {
        return HASHS.length;
    }

    private final static byte DIAMETER = 6;
    private final static boolean FUNCTIONAL = false;

    private final static int[] HASHS = new int[]{
            -2133101747, -2129264906, -2127400294, -2118842148, -2116198713, -2114446392, -2113420786, -2111803129, -2100287608, -2098719325, -2090470536, -2088589671, -2079869647, -2078239523, -2075013767, -2066149583, -2061858470, -2048744567, -2038449433, -2035159454, -2030939070, -2016611688, -2015207159, -2014412235, -2013077745, -2009324839, -2008051339, -2000301424, -1997107826, -1993148702, -1991172118, -1990936400, -1989183040, -1988899226, -1988521759, -1985886593, -1982558098, -1981617739, -1979806625, -1979469499, -1978583541, -1977804104, -1971782385, -1967232106, -1962780935, -1951192287, -1947300539, -1947150114, -1945508972, -1943046520, -1940402703, -1940086373, -1939372245, -1923447330, -1915283553, -1913006379, -1910496346, -1908652580, -1907512946, -1907119120, -1902313901, -1901000158, -1898341552, -1895867115, -1892509888, -1885755138, -1882818802, -1881371249, -1880585612, -1879818798, -1879144482, -1877513257, -1876567787, -1875313246, -1873618087, -1870464445, -1867700586, -1865248515, -1852235904, -1848132561, -1845902718, -1835899761, -1830540618, -1830139981, -1829124410, -1826823177, -1826502071, -1820888521, -1818571805, -1818417626, -1814480656, -1813709073, -1812997732, -1812822688, -1811998909, -1809286557, -1809110872, -1802258967, -1798268938, -1796688744, -1790384163, -1780596051, -1779675387, -1775678273, -1773926864, -1771811752, -1767132382, -1766293945, -1765892857, -1764236233, -1762033451, -1761630845, -1755407797, -1754412426, -1752481222, -1749940749, -1748678953, -1744228371, -1740965959, -1740310558, -1727095146, -1726411004, -1725083963, -1723212788, -1718156420, -1712688486, -1711008826, -1710293230, -1708896615, -1701548850, -1698628981, -1697591090, -1685505461, -1683369358, -1675366598, -1673058815, -1666590604, -1660638692, -1653159032, -1652859653, -1652524484, -1646387028, -1645677417, -1642050756, -1636305649, -1632669158, -1631683446, -1626371187, -1622876630, -1611302312, -1610674945, -1610362824, -1606665820, -1603388372, -1589667067, -1587174787, -1583749151, -1582029447, -1581189927, -1579216876, -1578006997, -1575340491, -1570124190, -1567073109, -1562560787, -1558421588, -1556324144, -1552675081, -1550004731, -1547802715, -1547341009, -1546849916, -1545545675, -1541428646, -1539020713, -1536459552, -1528921783, -1528894007, -1527844587, -1527304811, -1523736140, -1519673729, -1516701686, -1515694281, -1512767135, -1511044379, -1510632028, -1505367857, -1502215992, -1497272171, -1495635308, -1494889718, -1492999181, -1491080531, -1490440810, -1489063853, -1487905147, -1487776192, -1487734343, -1484987010, -1483710573, -1475563889, -1473871984, -1471820504, -1469934531, -1465867719, -1463765727, -1462727600, -1461276143, -1456945678, -1455150444, -1451055362, -1440557769, -1440332210, -1439643288, -1437803757, -1437736310, -1435948480, -1425228711, -1422544373, -1418524857, -1416304748, -1416211203, -1416132094, -1408792600, -1408738144, -1407663981, -1405643938, -1400604834, -1395565734, -1391505150, -1390847202, -1387209137, -1384760007, -1382679444, -1372918383, -1370084010, -1367077812, -1366464498, -1360598103, -1357149635, -1356535210, -1344921128, -1330650921, -1320652355, -1320248682, -1317393583, -1312224247, -1310275643, -1310171863, -1309823907, -1306911447, -1303308358, -1301889497, -1300070397, -1296459168, -1293861854, -1293643276, -1289918211, -1279756466, -1268497225, -1268019940, -1262288133, -1258176193, -1249276398, -1246839086, -1239881120, -1226606999, -1224721082, -1222182299, -1221936599, -1218077823, -1212066901, -1208683231, -1208673508, -1203465184, -1198671713, -1198579342, -1188788097, -1172201955, -1170606108, -1166429200, -1165423285, -1152067913, -1151918788, -1144474207, -1140140689, -1138954930, -1138607847, -1136248396, -1132643841, -1131664203, -1129945935, -1126520694, -1122709075, -1122640967, -1119870119, -1114578074, -1113390619, -1112979544, -1111540675, -1109216669, -1107815148, -1103190781, -1098747632, -1097869093, -1093936397, -1093899526, -1093002246, -1092111146, -1088309769, -1076656476, -1072480744, -1065098967, -1064027736, -1061401120, -1057851398, -1057586223, -1056398017, -1053894325, -1052472396, -1046544781, -1044875569, -1042798131, -1042683698, -1041169791, -1036567667, -1033110104, -1033052443, -1030518980, -1028866103, -1027596680, -1027418143, -1013020258, -1007817578, -1006701866, -999136859, -998366962, -994974466, -991224064, -990483450, -976978605, -974219664, -972818118, -968522547, -967854336, -965273245, -962019956, -959233247, -957406586, -954956024, -954656184, -949922095, -942661042, -942608851, -936864980, -936068885, -935270644, -932606188, -924978203, -919198476, -912573744, -907818610, -907583172, -905072024, -902346470, -897661650, -894035143, -892274284, -888784952, -887845395, -883568068, -868007456, -865247766, -857271761, -855246531, -854208709, -850210071, -848364963, -845484778, -844838506, -842113353, -836869666, -835845331, -825038615, -821166893, -821081693, -820440054, -813992791, -813455230, -806714497, -802754883, -800138121, -798682561, -797248712, -794531118, -793255884, -792571690, -791048676, -789878326, -787172584, -780568915, -779429577, -778768131, -778236959, -776406472, -772311210, -768317686, -762012017, -760830187, -758578314, -756329176, -756242627, -754351381, -743356724, -742488149, -741821506, -738982927, -731970470, -730403708, -728410349, -727791608, -726461416, -723236929, -722842633, -721626104, -720863186, -720559310, -718875857, -717078234, -714397968, -709310404, -700500653, -696415899, -696050552, -695529673, -694818302, -694350086, -692110724, -691849766, -686690023, -685523414, -682620785, -679590350, -675033101, -673771416, -673354734, -672495339, -672330321, -671076222, -669040371, -657988688, -656413330, -651948710, -650803413, -649339327, -649142639, -646300253, -644987691, -644704945, -639281139, -636984940, -635541361, -634035353, -633366949, -630430283, -627200503, -626473936, -617269192, -616751961, -614966677, -614069525, -613522832, -600922952, -597732595, -593973181, -583455500, -580545277, -579850901, -579379739, -578595456, -576780029, -576217112, -574618750, -573249317, -571041594, -570945076, -568302198, -563222046, -560707800, -560307650, -559534740, -554489181, -550206407, -545383393, -542139988, -542016813, -529907512, -521438719, -521344716, -515738703, -513960452, -513573682, -512329103, -506431380, -504520684, -501723857, -498806130, -498609295, -493642989, -485175252, -472071459, -461702796, -461174467, -460346884, -454338327, -453707633, -450110441, -449494886, -447465319, -442499072, -437838382, -425437380, -425149915, -421814655, -417105164, -414937772, -410910402, -410245795, -409565634, -408578195, -406247378, -403312500, -396794119, -395837883, -395235387, -391791710, -388461306, -388053664, -387675507, -385985089, -384410145, -378992656, -376234493, -375752247, -372429497, -361284158, -359112264, -357265425, -354001933, -349239224, -346815457, -343014357, -341525852, -336451300, -336138865, -332411907, -329509227, -329353700, -328985447, -325835814, -325293360, -322833075, -319037129, -317595691, -316621138, -315326782, -312200086, -309282258, -307429614, -304484942, -303989088, -293830215, -289751714, -289266965, -287627881, -287347787, -286438060, -281691030, -281044599, -278371935, -276381974, -270015709, -264199555, -260689379, -260367537, -256196967, -255970191, -254403391, -249267419, -247928236, -246102830, -241636470, -241069997, -238265864, -237123805, -236194509, -221339742, -218737806, -217621903, -207889694, -207564655, -201109974, -199890657, -198867271, -197342947, -196086720, -196020680, -194354518, -190655972, -187592023, -187412299, -185980157, -178319266, -174175983, -172846275, -170144277, -166144269, -163645544, -160203532, -159505073, -156450906, -145880402, -145809275, -143654417, -137870270, -131080542, -130888655, -126021086, -122744559, -117282607, -116856245, -102254937, -101929123, -96540735, -88122504, -87837803, -82877736, -74014341, -69088625, -63161233, -62244257, -61517462, -60417561, -54835843, -51283149, -48888163, -42597081, -41066479, -38581214, -26207638, -23853338, -22734183, -20226574, -14241385, -11147740, -10022428, -8515880, -4956467, -4909195, -4322946, -2923847, 2983268, 3809543, 6502934, 7633978, 13619651, 15546368, 15555776, 16447962, 19868814, 20560537, 22892147, 24759605, 25826262, 26740898, 27835356, 31424298, 32027375, 38965984, 51159737, 56394458, 56632465, 58265525, 59526723, 60365018, 62715699, 76180904, 79025733, 81917727, 85582011, 85772366, 90691546, 91423805, 94975757, 98523096, 102972574, 103266951, 108636634, 109929143, 115694292, 120557811, 124802898, 125106631, 126981846, 127855915, 128727849, 132426865, 134489603, 136183506, 137403406, 137513400, 138675309, 140653325, 140710659, 151251816, 161750584, 162018711, 167583836, 171766927, 171935693, 172807898, 177142293, 177451851, 179497397, 195888619, 197147062, 197304973, 199863420, 202072127, 202751495, 203249653, 210719562, 210816324, 211959256, 215159282, 215647122, 215879591, 220261446, 220982843, 222552346, 228771567, 228898741, 228942416, 229166175, 233809671, 235976542, 238030198, 238330930, 239214786, 241476243, 244253250, 248178300, 248796699, 251156241, 251809297, 255402161, 258833948, 261274080, 266845029, 266887770, 267594301, 268338924, 269152622, 275330665, 276916626, 279565555, 281733252, 285727324, 286798084, 291519126, 291627871, 292217548, 293947614, 297087048, 298589457, 303431746, 305370792, 306559967, 308530402, 309413083, 310281660, 321481395, 321584247, 322081810, 323342614, 323487347, 326606755, 327617498, 328901995, 332272588, 333421783, 335828395, 336826927, 336831837, 338052253, 338481266, 342113914, 344662488, 348603230, 352489968, 356610628, 362314941, 368987307, 369796785, 370144022, 370361520, 373728394, 382620176, 386441587, 387879913, 389141011, 398231069, 400201001, 400846727, 401570022, 404963357, 405437983, 407053150, 415188071, 416352167, 417066774, 417519190, 421118033, 423552486, 425167710, 428158769, 434082869, 435611312, 435730623, 435820535, 436781095, 439108570, 439385156, 440397285, 441359045, 445745511, 446460609, 446997883, 450757500, 469808296, 472309586, 476208392, 487411830, 488940089, 497081717, 498627181, 500210798, 502291682, 512016408, 514258043, 514426366, 519008602, 520797564, 524532262, 526635602, 531425232, 536752715, 546250706, 557796487, 562085761, 562573161, 568953087, 574066762, 575052803, 577291173, 590078970, 590377060, 591735635, 594801609, 597609106, 598483088, 602866671, 609679885, 610466850, 626159161, 626767077, 633255649, 635393948, 643422945, 648517016, 649679972, 660195086, 662121801, 664232910, 679726426, 682978549, 689905106, 692224043, 693237630, 694799381, 697121418, 698046480, 699053609, 706832882, 707466006, 711697048, 712526115, 713192352, 714849342, 722440376, 722879561, 724766404, 726667079, 733092149, 734298008, 735175544, 741203922, 742839105, 744800379, 749230230, 753467901, 757526877, 758163029, 759096630, 759428262, 760493166, 761060141, 770001334, 770840141, 773768924, 785309856, 786494180, 794521676, 800617161, 804644554, 805214945, 813034181, 815831907, 816858206, 819803335, 821881862, 823788428, 824315401, 825446697, 825661105, 826407884, 826886579, 831400192, 840131337, 851250972, 855249614, 857238908, 862938836, 871871684, 872781564, 874021254, 877247232, 880645671, 884797313, 886335437, 886494467, 886997353, 893019000, 902531987, 905192134, 906056047, 910743996, 911445337, 913602609, 914252105, 921661730, 924408534, 926112426, 928612506, 935495642, 939291793, 940677290, 942206066, 945487159, 946843300, 947491208, 947801467, 954480120, 957663557, 959184509, 963765076, 966275109, 977034953, 980374877, 983803665, 987820094, 989208048, 993182945, 1001976897, 1004183938, 1007853943, 1010418621, 1012808755, 1022770178, 1024131100, 1024300589, 1025545952, 1027556089, 1038594748, 1041412411, 1045999463, 1046107682, 1057057057, 1060960655, 1063144429, 1065518908, 1067604977, 1070776755, 1080492418, 1088418660, 1090566755, 1091760067, 1095881712, 1096714520, 1096896483, 1097944255, 1098050769, 1098501648, 1101238811, 1104528837, 1108580232, 1109653045, 1111002994, 1116036505, 1116238253, 1116562033, 1116639252, 1119001610, 1122177054, 1127152178, 1129216781, 1129525843, 1131571373, 1132232178, 1134789947, 1136072639, 1138096600, 1140999339, 1143763446, 1143940639, 1151725240, 1152764754, 1154951536, 1154955088, 1155143426, 1157076752, 1162193838, 1163511423, 1165663487, 1171603231, 1171751026, 1172880295, 1173992272, 1187172105, 1187188046, 1190136605, 1191484434, 1193869764, 1194344443, 1194907145, 1196777041, 1206022251, 1213683322, 1216239371, 1219037133, 1224293249, 1232045252, 1235079416, 1243696693, 1246336219, 1246468836, 1254273825, 1256656789, 1257321794, 1257695465, 1262412136, 1271794066, 1275263229, 1276551001, 1282958070, 1284619186, 1284973593, 1285351505, 1286833445, 1291862412, 1296622114, 1305378304, 1305408708, 1307368755, 1312435574, 1314810931, 1316528246, 1318135666, 1321041959, 1322228515, 1323701668, 1324550524, 1328656293, 1328835015, 1330536927, 1330855203, 1334892124, 1338306124, 1339989899, 1346276707, 1349350917, 1359042374, 1361422377, 1364433856, 1365504715, 1371574255, 1376676412, 1386759999, 1389261169, 1397850344, 1402621906, 1405632123, 1406171664, 1407396397, 1408025282, 1410547389, 1410943290, 1417351922, 1438529570, 1441249555, 1448699660, 1455472815, 1458141992, 1458870108, 1459714468, 1461015574, 1461398474, 1464808710, 1465744550, 1466704646, 1471413877, 1472761843, 1478413981, 1479434575, 1483685289, 1488185428, 1492817511, 1498326252, 1499507472, 1506208925, 1509518994, 1510543024, 1511160640, 1511608997, 1512281078, 1518383620, 1519740944, 1525856114, 1528002862, 1534252408, 1535425789, 1551367142, 1552213789, 1552921113, 1555341195, 1557870829, 1562683811, 1570500566, 1573180595, 1574643079, 1580202494, 1580559118, 1583419672, 1584196159, 1587446822, 1589884629, 1593561974, 1597127019, 1611167600, 1613954165, 1615707026, 1618732553, 1626799586, 1628367969, 1628396750, 1629670901, 1630125185, 1632880164, 1635138742, 1658856930, 1665770033, 1670998313, 1671584459, 1677266112, 1678903509, 1680197806, 1682648256, 1685226056, 1686211010, 1691981097, 1693698380, 1695126815, 1703528201, 1714056933, 1726895964, 1736735008, 1738221535, 1738665930, 1746261604, 1747519975, 1749637777, 1751031061, 1752581655, 1753355760, 1754593609, 1754809883, 1755409555, 1760283666, 1765138320, 1776828876, 1782110223, 1782121912, 1786330460, 1796811887, 1801291869, 1805809628, 1805931146, 1807279404, 1807926978, 1812173935, 1817405570, 1817855303, 1818168657, 1825646404, 1832851096, 1836228875, 1848817746, 1848871558, 1853783982, 1865038436, 1866430202, 1876404817, 1877262781, 1881441957, 1883664133, 1884730503, 1885681029, 1892960349, 1896594146, 1897390832, 1899249268, 1901799279, 1902207349, 1904696679, 1905657469, 1917611661, 1917827775, 1924365693, 1924487211, 1928480249, 1929314898, 1930090451, 1931971844, 1938522974, 1938966668, 1939552315, 1939712283, 1939784466, 1941345485, 1944796685, 1946066341, 1952295104, 1955301071, 1957338289, 1957721163, 1959044578, 1965638577, 1972062118, 1978230478, 1987361411, 1987655240, 1991398792, 1992128463, 1993392309, 1994067521, 1995323319, 2000411614, 2001424135, 2002903165, 2012362362, 2014303412, 2023019888, 2025654196, 2026271774, 2031693381, 2034109191, 2041451239, 2044164800, 2046297419, 2053936066, 2055869973, 2066741278, 2066781312, 2073228210, 2074714955, 2078126852, 2078172560, 2081954610, 2084044432, 2085687989, 2086630413, 2089987337, 2091117761, 2092544724, 2095208311, 2095654789, 2095823728, 2096041822, 2098624156, 2101068825, 2110174460, 2111861897, 2117385517, 2120802630, 2126775190, 2130100000, 2130908821, 2135424926, 2137965023, 2143408247, 2145614241, 2146863737, 2147204365
    };

    @Override
    public String getDescription() {
        return (isFunctional ? "FCFP" : "ECFP") + diameter + ":" + hash;
    }
}
